swagger: '2.0'
info:
  description: This is the order API
  version: 1.0.0
  title: Order API
  termsOfService: 'https://api.tdshop.io/'
basePath: /
tags:
  - name: Cart
    description: Cart Profile
  - name: Order
    description: Order Profile
schemes:
  - https
  - http
paths:
  '/carts/{storeId}/summary':
    get:
      tags:
        - Cart
      summary: Get Cart Summary
      operationId: getCartSummary
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: storeId
          in: path
          description: Store id
          required: true
          type: string
      responses:
        '200':
          description: successful operation
          schema:
            type: object
            properties:
              numberOfItems:
                type: integer
              amount:
                type: number
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Store not found
      security:
        - oAuth2:
            - read    
  '/carts/{storeId} ':
    post:
      tags: 
        - Cart
      summary: Create Cart
      operationId: createCart
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: storeId
          in: path
          description: Store id
          required: true
          type: string
        - name: body
          in: body
          description: New cart payload
          required: true
          schema:
            $ref: '#/definitions/Cart'
      responses:
        '200':
          description: successful operation
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Store not found
      security:
        - oAuth2:
            - write
  '/carts/{cartId}/checkCartDetails':
    put:
      tags:
        - Cart
      summary: Update Cart and Check Product Details
      operationId: checkCartDetails
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: cartId
          in: path
          description: Cart id
          required: true
          type: string
      responses:
        '200':
          description: successful operation
          schema:
            $ref: '#/definitions/Cart'
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Cart not found
      security:
        - oAuth2:
            - write
  '/carts/{cartId}/addItem':
    put:
      tags:
        - Cart
      summary: Add Item
      operationId: addItem
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: x-user-id
          in: header
          description: user id
          required: true
          type: string
        - name: cartId
          in: path
          description: Cart id
          required: true
          type: string
        - name: body
          in: body
          description: New cart payload
          required: true
          schema:
            type: object
            properties:
              version:
                type: integer
                format: int64
              barcode:
                type: string
              qty:
                type: integer
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/Cart'
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Store not found
      security:
        - oAuth2:
            - write
  '/carts/{cartId}/updateItem':
    put:
      tags:
        - Cart
      summary: Update Item
      operationId: updateItem
      consumes:
        - application/json
      produces:
        - application/json
      parameters:  
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: x-user-id
          in: header
          description: user id
          required: true
          type: string
        - name: cartId
          in: path
          description: Cart id
          required: true
          type: string
        - name: body
          in: body
          description: New cart payload
          required: true
          schema:
            type: object
            properties:
              id:
                type: string
              version:
                type: integer
                format: int64
              barcode:
                type: string
              qty:
                type: integer
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/Cart'
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Store not found
      security:
        - oAuth2:
            - write
  '/carts/{cartId}/{barcode}':
    put:
      tags:
        - Cart
      summary: Delete Item
      operationId: deleteItem
      consumes:
        - application/json
      produces:
        - application/json
      parameters:  
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: cartId
          in: path
          description: Cart id
          required: true
          type: string
        - name: barcode
          in: path
          description: Barcode id
          required: true
          type: string
        - name: x-user-id
          in: header
          description: User id
          required: true
          type: string
      responses:
        '200':
          description: OK
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Cart not found
      security:
        - oAuth2:
            - write
  '/carts/{cartId}/deleteInvalidItems':
    put:
      tags:
        - Cart
      summary: Delete All Invalid Items
      operationId: deleteInvalidItem
      consumes:
        - application/json
      produces:
        - application/json
      parameters:  
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: cartId
          in: path
          description: Cart id
          required: true
          type: string
        - name: x-user-id
          in: header
          description: User id
          required: true
          type: string
      responses:
        '200':
          description: OK
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Cart not found
      security:
        - oAuth2:
            - write
  '/carts/{cartId}/empty':
    put:
      tags:
        - Cart
      summary: Empty Cart
      operationId: emptyCart
      consumes:
        - application/json
      produces:
        - application/json
      parameters:  
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: cartId
          in: path
          description: Cart id
          required: true
          type: string
      responses:
        '200':
          description: OK
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Store not found
      security:
        - oAuth2:
            - write
  '/carts/{cartId}/saveNote':
    put:
      tags:
        - Cart
      summary: Save Note
      operationId: saveNote
      consumes:
        - application/json
      produces:
        - application/json
      parameters:  
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: cartId
          in: path
          description: Cart id
          required: true
          type: string
        - name: body
          in: body
          description: note in cart
          required: true
          schema:
            type: object
            properties:
              additionalNote:
                type: string
      responses:
        '200':
          description: OK
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Store not found
      security:
        - oAuth2:
            - write
  '/orders/{orderNo}':
    get:
      tags:
        - Order
      summary: Get Order
      operationId: findOrderByNo
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: orderNo
          in: path
          description: Order number
          required: true
          type: string
      responses:
        '200':
          description: successful operation
          schema:
            $ref: '#/definitions/Order'
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Order not found
      security:
        - oAuth2:
            - read
  '/orders':
    get:
      tags:
        - Order
      summary: Get Order
      operationId: findOrders
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: merchantId
          in: query
          description: Merchant Id
          required: false
          type: string
        - name: storeId
          in: query
          description: Store Id
          required: false
          type: string
      responses:
        '200':
          description: successful operation
          schema:
            $ref: '#/definitions/Order'
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Order not found
      security:
        - oAuth2:
            - read
  '/orders/fetchData':
    get:
      tags:
        - Order
      summary: Fetch Order
      operationId: fetchOrders
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: merchantId
          in: query
          description: Merchant Id
          required: false
          type: string
        - name: storeId
          in: query
          description: Store Id
          required: false
          type: string
        - name: resumeAt
          in: query
          description: Resume at
          required: false
          type: string
      responses:
        '200':
          description: successful operation
          schema:
            $ref: '#/definitions/Order'
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Order not found
      security:
        - oAuth2:
            - read
  '/orders ':
    post:
      tags:
        - Order
      summary: Create Order
      operationId: createOrder
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: body
          in: body
          description: Order payload
          required: true
          schema:
            type: object
            properties:
              cart:
                type: string
              additionalNote:
                type: string
      responses:
        '200':
          description: successful operation
          schema:
            $ref: '#/definitions/Order'
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Cart not found
      security:
        - oAuth2:
            - write
  '/orders  ':
    put:
      tags:
        - Order
      summary: Update Order
      operationId: updateOrder
      consumes:
        - application/json
      produces:
        - application/json
      parameters:
        - name: x-host
          in: header
          description: Custom host header as "order.api.tdshop.io"
          required: true
          type: string
        - name: body
          in: body
          description: Order payload
          required: true
          schema:
            $ref: '#/definitions/Order'
      responses:
        '200':
          description: successful operation
          schema:
            $ref: '#/definitions/Order'
        '401':
          description: |
            Not authorized, refer to www-authenticate header to describe an error 
            Example: Bearer error="invalid_token", error_description="Jwt expired at 2019-02-12T12:00:04Z", error_uri="https://tools.ietf.org/html/rfc6750#section-3.1"
        '404':
          description: Order not found
      security:
        - oAuth2:
            - write
securityDefinitions:
  oAuth2:
    type: oauth2
    flow: accessCode
    authorizationUrl: 'https://api.tdshop.io'
    tokenUrl: 'https://api.tdshop.io/auth/token'
    scopes:
      read: Grants read access
      write: Grants write access
definitions:
  Cart:
    type: object
    description: Cart
    required:
      - status
      - merchant
      - store
      - items
      - amount
    properties:
      id:
        type: string
      version:
        type: integer
        format: int64
      status:
        type: string
      merchant:
        type: string
      store:
        type: string
      items:
        type: array
        items:
          $ref: '#/definitions/Item'
      amount:
        type: number
      createdDate:
        type: string
      createdBy:
        type: string
      lastModifiedDate:
        type: string
      lastModifiedBy:
        type: string
      lastSavedDate:
        type: string
      additionalNote:
        type: string
  Item:
    type: object
    description: Item
    required:
      - barcode
      - articleNo
      - productName
      - productStatus
      - catalogLV1
      - catalogLV2
      - unit
      - articleType
      - unitFactor
      - retailPrice
      - retailPricePerUnit
      - wholesalePrice
      - wholesalePricePerUnit
      - profitPerUnit
      - qty
      - totalQty
      - vat
      - amount
      - remainingStock
      - averageSell
      - addedDate
    properties:
      barcode:
        type: string
      articleNo:
        type: string
      productName:
        type: string
      productStatus:
        type: string
      catalogLV1:
        type: string
      catalogLV2:
        type: string
      uom:
        type: string
      unit:
        type: string
      articleType:
        type: string
      productGrading:
        type: integer
      productImage:
        $ref: '#/definitions/ImageDto'
      unitFactor:
        type: integer
      retailPrice:
        type: number
      retailPricePerUnit:
        type: number
      wholesalePrice:
        type: number
      wholesalePricePerUnit:
        type: number
      profitPerUnit:
        type: number
      qty:
        type: integer
      totalQty:
        type: integer
      vat:
        type: boolean
      amount:
        type: number
      remainingStock:
        type: integer
      averageSell:
        type: number
      addedDate:
        type: string
  ImageDto:
    type: object
    description: ImageDto
    properties:
      id:
        type: string
      original:
        type: string
      small:
        type: string
      medium:
        type: string
  CartStatusType:
    type: object
    description: CartStatusType
    properties:
      name:
        type: string
        enum:
        - INITIAL
        - MODIFIED
  Order:
    type: object
    description: Order
    required:
    - merchant
    - merchantNo
    - store
    - storeNo
    - storeName
    - poNumber
    - poType
    - poDate
    - items
    - poStatus
    - itemAmount
    - vatAmount
    - amount
    - orderBy
    - orderByName
    - orderByLocalName
    - shipTo
    properties:
      id:
        type: string
      version:
        type: integer
        format: int64
      merchant:
        type: string
      merchantNo:
        type: string
      store:
        type: string
      storeNo:
        type: string
      storeName:
        type: string
      poNumber:
        type: string
      poType:
        type: string
      poDate:
        type: string
      items:
        type: array
        items:
          $ref: '#/definitions/Order.Item'
      poStatus:
        type: string
      itemAmount:
        type: number
      vatAmount:
        type: number
      amount:
        type: number
      additionalNote: 
        type: string
      orderBy:
        type: string
      orderByName:
        type: string
      orderByLocalName:
        type: string
      shipTo:
        $ref: '#/definitions/ShipTo'
      createdDate:
        type: string
      createdBy:
        type: string
      lastModifiedDate:
        type: string
      lastModifiedBy:
        type: string
  Order.Item:
    type: object
    description: Order.Item
    required:
    - itemNo
    - barcode
    - articleNo
    - productName
    - productStatus
    - qty
    - unit
    - vat
    - wholesalePrice
    - unitFactor
    - itemAmount
    - vatAmount
    - amount
    properties:
      itemNo:
        type: integer
      barcode:
        type: string
      articleNo:
        type: string
      productName:
        type: string
      productStatus:
        type: string
      qty:
        type: integer
      unit:
        type: string
      vat:
        type: boolean
      wholesalePrice:
        type: number
      unitFactor: 
        type: integer
      itemAmount:
        type: number
      vatAmount:
        type: number
      amount:
        type: number
  ShipTo:
    type: object
    description: ShipTo
    properties:
      address:
        type: string
      state:
        type: string
      postcode:
        type: string
      country:
        type: string
      countryCode:
        type: string
      mobileNo:
        type: string
        